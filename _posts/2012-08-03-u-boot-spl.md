---
layout: post
title: "u boot spl"
description: ""
category: 
tags: []
---
{% include JB/setup %}
#0. include/configs/mini2440.h 与 include/autoconf.mk
autoconf.mk被Makefile所包含(Makefile中有些使用的宏就来自一些头文件中)，autoconf.mk是由一个autoconf.mk.dep文件生成的，这个文件中列出了很多头文件。包括include/configs/mini2440.h。
这就是`u-boot`的一个特别的地方。

#1. spl/Makefile
u-boot-spl是由哪些文件编译成的就在这个文件中了。

#2. spl加载主u-boot
当是spl构建时会有CONFIG_SPL_BUILD定义，这个要自己处理好在哪里载入u-boot。
我的一个做法是在board_init_r中，因为这个在CONFIG_SPL_BUILD没有被定义。

    void board_init_r(gd_t *id, ulong dest_addr)
    {
        nand_init();
        nand_boot(); 
    }

nand_init与nand_boot都是`drivers/mtd/nand/nand_spl_simple.c`中定义的。
这个文件要被编译的话，要编译三个宏。CONFIG_CMD_NAND、CONFIG_SPL_BUILD、CONFIG_SPL_NAND_SIMPLE。

1.nand_init需要的宏
